# üõ°Ô∏è Malware Containment & Response Checklist

## üß™ Step 1: Detection & Triage
- [ ] Alert triggered by EDR, AV, SIEM, or user report
- [ ] Identify indicators of compromise (hashes, file paths, registry keys)
- [ ] Run triage scans:
  - Windows: `Get-MpThreatDetection`, `Autoruns`, `Sysinternals Suite`
  - Linux: `chkrootkit`, `rkhunter`, `ps`, `netstat`
- [ ] Collect initial system info:
  ```powershell
  systeminfo
  Get-EventLog -LogName Security -Newest 100
````

```bash
uname -a
lastlog
journalctl -p err
```

## üö® Step 2: Containment

* [ ] Immediately isolate infected host:

  * Disable network adapter or VLAN quarantine
  * EDR isolation (CrowdStrike, SentinelOne, Defender ATP)
* [ ] Block outbound C2 domains/IPs on firewall or proxy
* [ ] Identify and disconnect lateral connections
* [ ] Disable compromised accounts (AD, LDAP)

## üßπ Step 3: Eradication

* [ ] Remove malicious binaries and persistence mechanisms:

  * Delete known bad files
  * Remove autorun entries (`regedit`, `schtasks`, `crontab`, `/etc/init.d/`)
* [ ] Clean up registry keys / scheduled tasks
* [ ] Run full AV/EDR scan
* [ ] Kill malicious processes:

  ```bash
  ps aux | grep <malware_name>
  kill -9 <PID>
  ```
* [ ] Reimage system (if full compromise suspected)

## üîÅ Step 4: Recovery

* [ ] Patch vulnerabilities (e.g., unpatched software, RCE flaws)
* [ ] Restore clean backups if necessary
* [ ] Reset user passwords
* [ ] Re-enable monitoring tools, EDR, AV
* [ ] Conduct final health check on system performance, logs

## üß† Step 5: Lessons Learned

* [ ] Analyze malware sample in sandbox (e.g., Cuckoo, Any.run)
* [ ] Extract IOCs and submit to threat intel platforms (MISP, VirusTotal)
* [ ] Update detection rules (YARA, Sigma, EDR policies)
* [ ] Brief SOC team on TTPs used and attack vector
* [ ] Share anonymized findings with ISAC or threat-sharing group

---

## üõ† Tools To Use

* `Sysmon`, `Autoruns`, `Wireshark`, `Volatility`, `YARA`, `OSQuery`
* Windows: Defender ATP, Sysinternals, Powershell
* Linux: `lsof`, `netstat`, `chkrootkit`, `auditd`, `rkhunter`

---

## üîç MITRE ATT\&CK Mapping

* **Initial Access**:

  * T1203 ‚Äì Exploitation for Client Execution
  * T1566 ‚Äì Phishing
* **Execution**:

  * T1059 ‚Äì Command and Scripting Interpreter
  * T1047 ‚Äì Windows Management Instrumentation
* **Persistence**:

  * T1547 ‚Äì Boot or Logon Autostart Execution
* **Privilege Escalation**:

  * T1055 ‚Äì Process Injection
* **Defense Evasion**:

  * T1140 ‚Äì Deobfuscate/Decode Files or Information
* **Command and Control**:

  * T1071 ‚Äì Application Layer Protocol
  * T1105 ‚Äì Ingress Tool Transfer

---

## üìÅ Related Files

* `collect_forensics.ps1` ‚Äì grab memory, registry, logs
* `ioc_extractor.py` ‚Äì parse logs for hashes, IPs, domains
* `isolate_host.ps1` ‚Äì auto-disable NICs, notify team

---

## üß∑ Notes

* Isolate > Analyze > Eradicate ‚Äî **do not reboot system** before capturing volatile data
* Maintain chain-of-custody for any forensic evidence
* Report breaches under applicable laws (GDPR, HIPAA, etc.)

```

---

