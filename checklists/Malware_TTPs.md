# 💣 Malware MITRE ATT&CK Technique Mapping

This document maps key malware behaviors to relevant MITRE ATT&CK TTPs to aid in detection, analysis, and defensive countermeasures.

---

## 🧪 Initial Access
- **T1566.001** – Spearphishing Attachment  
  Malware delivered via malicious attachments (Office macros, PDFs, etc.)

- **T1189** – Drive-by Compromise  
  Exploits delivered through vulnerable web browsers or plugins.

- **T1190** – Exploit Public-Facing Application  
  Malware used post-compromise for persistence or lateral movement.

---

## ⚙️ Execution
- **T1059** – Command and Scripting Interpreter  
  Malware using PowerShell, Bash, Python, JavaScript for execution.

- **T1204** – User Execution  
  Relies on users clicking, opening, or running malicious files.

- **T1047** – Windows Management Instrumentation (WMI)  
  Used for malware execution or lateral movement.

---

## 🛠 Persistence
- **T1547.001** – Registry Run Keys / Startup Folder  
  Malware adds entries for re-execution on reboot.

- **T1053.005** – Scheduled Task/Job: Scheduled Task  
  Used to maintain persistence or delay execution.

- **T1037** – Boot or Logon Initialization Scripts  
  .bat/.ps1 scripts configured to auto-run on login.

---

## 🔐 Privilege Escalation
- **T1055** – Process Injection  
  Injecting into legitimate processes to hide execution.

- **T1068** – Exploitation for Privilege Escalation  
  Kernel or OS vulnerabilities exploited to gain elevated access.

- **T1134.001** – Access Token Manipulation: Token Impersonation  
  Masquerading as other users for privilege escalation.

---

## 🕵️ Defense Evasion
- **T1027** – Obfuscated Files or Information  
  Encoded or packed binaries to avoid detection.

- **T1140** – Deobfuscate/Decode Files or Information  
  Malware decodes itself during runtime.

- **T1070** – Indicator Removal on Host  
  Clears logs or disables logging to hide traces.

- **T1562** – Impair Defenses  
  Disabling security tools (e.g., AV, firewall).

---

## 🧠 Credential Access
- **T1003** – OS Credential Dumping  
  `lsass.exe`, Mimikatz, or SAM hive access to extract credentials.

- **T1056** – Input Capture (Keylogging)  
  Logs keystrokes, clipboard, or user input.

---

## 🔄 Lateral Movement
- **T1021** – Remote Services (RDP, SMB, SSH)  
  Malware spreads to other systems over trusted services.

- **T1080** – Taint Shared Content  
  Infects files on shared drives or cloud sync folders.

---

## 📤 Exfiltration
- **T1041** – Exfiltration Over C2 Channel  
  Sends stolen data via same C2 used for communication.

- **T1052.001** – Exfil via Removable Media  
  Copies data to USB drives.

- **T1020** – Automated Exfiltration  
  Data is periodically zipped and exfiltrated silently.

---

## 📡 Command & Control
- **T1071** – Application Layer Protocol  
  Uses HTTP/S, DNS, or custom protocols to maintain C2.

- **T1105** – Ingress Tool Transfer  
  Malware downloads additional payloads post-infection.

- **T1095** – Non-Application Layer Protocol  
  Custom or raw TCP/UDP-based communication.

---

## 💥 Impact
- **T1486** – Data Encrypted for Impact  
  Ransomware encryption activity.

- **T1490** – Inhibit System Recovery  
  Deletes shadow copies or disables recovery tools.

- **T1489** – Service Stop  
  Stops AV, backups, and monitoring services.

---

## 🔗 Related Detection Rules
Check `../sigma_rules/malware.yml` and `../checklists/Malware_Containment.md` for mapped detection strategies and response actions.

